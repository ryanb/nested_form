<%= nested_form_for Project.new do |f| -%>
  <%= f.text_field :name %>
  <div id="task-fields">
    <%= f.fields_for :tasks do |tf| -%>
      <%= tf.text_field :name %>
      <div id="milestone-fields">
        <%= tf.fields_for :milestones do |mf| %>
          <%= mf.text_field :name %>
          <%= mf.link_to_remove 'Remove milestone' %>
        <% end %>
      </div>
      <%= tf.link_to_add 'Add new milestone', :milestones, data: {target: '#milestone-fields'} %>
      <%= tf.link_to_remove 'Remove' %>
    <% end -%>
  </div>
  <%= f.link_to_add 'Add new task', :tasks, data: {target: '#task-fields'} %>
<% end -%>
